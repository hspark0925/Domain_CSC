




  1%|█▎                                                                                                                                   | 4/400 [11:05<18:13:33, 165.69s/it]



  2%|██▎                                                                                                                                  | 7/400 [19:22<18:05:28, 165.72s/it]




  3%|███▋                                                                                                                                | 11/400 [30:21<17:48:53, 164.87s/it]




  4%|████▉                                                                                                                               | 15/400 [41:21<17:38:28, 164.96s/it]





  5%|██████▌                                                                                                                             | 20/400 [55:07<17:25:21, 165.06s/it]



  6%|███████▍                                                                                                                          | 23/400 [1:03:22<17:16:25, 164.95s/it]





  7%|█████████                                                                                                                         | 28/400 [1:17:06<17:02:29, 164.92s/it]




  8%|██████████▍                                                                                                                       | 32/400 [1:28:06<16:51:20, 164.89s/it]




  9%|███████████▋                                                                                                                      | 36/400 [1:39:05<16:40:29, 164.92s/it]




 10%|█████████████                                                                                                                     | 40/400 [1:50:04<16:29:06, 164.85s/it]




 11%|██████████████▎                                                                                                                   | 44/400 [2:01:05<16:18:43, 164.95s/it]




 12%|███████████████▌                                                                                                                  | 48/400 [2:12:04<16:07:05, 164.85s/it]



 13%|████████████████▌                                                                                                                 | 51/400 [2:20:18<15:58:42, 164.82s/it]




 14%|█████████████████▉                                                                                                                | 55/400 [2:31:19<15:49:53, 165.20s/it]




 15%|███████████████████▏                                                                                                              | 59/400 [2:42:22<15:40:42, 165.52s/it]




 16%|████████████████████▍                                                                                                             | 63/400 [2:53:22<15:27:59, 165.22s/it]




 17%|█████████████████████▊                                                                                                            | 67/400 [3:04:25<15:18:52, 165.56s/it]




 18%|███████████████████████                                                                                                           | 71/400 [3:15:26<15:07:24, 165.48s/it]




 19%|████████████████████████▍                                                                                                         | 75/400 [3:26:28<14:56:27, 165.50s/it]




 20%|█████████████████████████▋                                                                                                        | 79/400 [3:37:30<14:45:37, 165.54s/it]




 21%|██████████████████████████▉                                                                                                       | 83/400 [3:48:33<14:34:51, 165.59s/it]




 22%|████████████████████████████▎                                                                                                     | 87/400 [3:59:34<14:22:34, 165.35s/it]





 23%|█████████████████████████████▉                                                                                                    | 92/400 [4:13:19<14:06:40, 164.94s/it]



 24%|██████████████████████████████▉                                                                                                   | 95/400 [4:21:33<13:58:27, 164.94s/it]




 25%|████████████████████████████████▎                                                                                                | 100/400 [4:35:19<13:46:09, 165.23s/it]
***** Running Evaluation *****
  Num examples = 58
  Batch size = 1
{'loss': 0.0199, 'grad_norm': 0.2643362879753113, 'learning_rate': 7.500000000000001e-05, 'epoch': 11.72}
























































 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 57/58 [02:28<00:02,  2.64s/it]

Saving model checkpoint to /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/other.py:619: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /Qwen/Qwen2-7B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fde4c28d8a0>: Failed to resolve \'huggingface.co\' ([Errno -3] Temporary failure in name resolution)"))'), '(Request ID: 815baece-b033-4b11-872c-7e07ed89cfe4)') - silently ignoring the lookup for the file config.json in Qwen/Qwen2-7B-Instruct.
  warnings.warn(
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/save_and_load.py:218: UserWarning: Could not find a config file in Qwen/Qwen2-7B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(
[2024-09-08 03:39:37,355] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step100 is about to be saved!
[2024-09-08 03:39:37,388] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-09-08 03:39:37,388] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-09-08 03:40:05,256] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-09-08 03:40:05,259] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-09-08 03:40:05,356] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-09-08 03:40:05,357] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-09-08 03:40:05,412] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step100 is ready now!
[2024-09-08 03:40:05,448] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step100 is about to be saved!
[2024-09-08 03:40:05,460] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-09-08 03:40:05,461] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-09-08 03:40:08,974] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-09-08 03:40:08,975] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-09-08 03:40:09,066] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-09-08 03:40:09,067] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-100/global_step100/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-09-08 03:40:09,106] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step100 is ready now!
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/other.py:619: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /Qwen/Qwen2-7B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fde581102b0>: Failed to resolve \'huggingface.co\' ([Errno -3] Temporary failure in name resolution)"))'), '(Request ID: b1580951-7489-4abe-af4a-9aa17f1c3948)') - silently ignoring the lookup for the file config.json in Qwen/Qwen2-7B-Instruct.
  warnings.warn(
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/save_and_load.py:218: UserWarning: Could not find a config file in Qwen/Qwen2-7B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(


 26%|█████████████████████████████████▏                                                                                               | 103/400 [4:47:23<16:24:24, 198.87s/it]




 27%|██████████████████████████████████▌                                                                                              | 107/400 [4:58:23<14:05:16, 173.09s/it]





 28%|████████████████████████████████████                                                                                             | 112/400 [5:12:07<13:17:35, 166.16s/it]




 29%|█████████████████████████████████████▍                                                                                           | 116/400 [5:23:06<13:01:27, 165.10s/it]




 30%|██████████████████████████████████████▋                                                                                          | 120/400 [5:34:05<12:49:51, 164.97s/it]




 31%|███████████████████████████████████████▉                                                                                         | 124/400 [5:45:05<12:38:18, 164.85s/it]




 32%|█████████████████████████████████████████▎                                                                                       | 128/400 [5:56:03<12:26:57, 164.77s/it]



 33%|██████████████████████████████████████████▏                                                                                      | 131/400 [6:04:18<12:18:33, 164.73s/it]





 34%|███████████████████████████████████████████▊                                                                                     | 136/400 [6:18:01<12:04:34, 164.68s/it]



 35%|████████████████████████████████████████████▊                                                                                    | 139/400 [6:26:15<11:56:17, 164.66s/it]




 36%|██████████████████████████████████████████████                                                                                   | 143/400 [6:37:13<11:44:51, 164.56s/it]




 37%|███████████████████████████████████████████████▍                                                                                 | 147/400 [6:48:12<11:34:29, 164.70s/it]




 38%|████████████████████████████████████████████████▋                                                                                | 151/400 [6:59:10<11:23:29, 164.70s/it]




 39%|█████████████████████████████████████████████████▉                                                                               | 155/400 [7:10:10<11:13:07, 164.85s/it]




 40%|███████████████████████████████████████████████████▎                                                                             | 159/400 [7:21:08<11:01:24, 164.67s/it]




 41%|████████████████████████████████████████████████████▌                                                                            | 163/400 [7:32:09<10:52:18, 165.14s/it]




 42%|█████████████████████████████████████████████████████▊                                                                           | 167/400 [7:43:08<10:39:51, 164.77s/it]




 43%|███████████████████████████████████████████████████████▏                                                                         | 171/400 [7:54:07<10:29:16, 164.88s/it]





 44%|████████████████████████████████████████████████████████▊                                                                        | 176/400 [8:07:52<10:15:24, 164.84s/it]



 45%|█████████████████████████████████████████████████████████▋                                                                       | 179/400 [8:16:06<10:06:59, 164.79s/it]




 46%|███████████████████████████████████████████████████████████▍                                                                      | 183/400 [8:27:06<9:55:46, 164.73s/it]




 47%|████████████████████████████████████████████████████████████▊                                                                     | 187/400 [8:38:04<9:44:38, 164.69s/it]





 48%|██████████████████████████████████████████████████████████████▍                                                                   | 192/400 [8:51:51<9:32:52, 165.25s/it]



 49%|███████████████████████████████████████████████████████████████▍                                                                  | 195/400 [9:00:06<9:23:52, 165.04s/it]




 50%|█████████████████████████████████████████████████████████████████                                                                 | 200/400 [9:13:51<9:09:34, 164.87s/it]
***** Running Evaluation *****
  Num examples = 58
  Batch size = 1
{'loss': 0.0027, 'grad_norm': 0.03846822679042816, 'learning_rate': 5e-05, 'epoch': 23.44}
























































 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 57/58 [02:28<00:02,  2.64s/it]

Saving model checkpoint to /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200
[2024-09-08 08:18:07,890] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step200 is about to be saved!
[2024-09-08 08:18:07,927] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-09-08 08:18:07,927] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt...
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/other.py:619: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /Qwen/Qwen2-7B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fde4c2cf790>: Failed to resolve \'huggingface.co\' ([Errno -3] Temporary failure in name resolution)"))'), '(Request ID: 0d7b2fdd-88e6-4dc4-bd76-356c851a0b4f)') - silently ignoring the lookup for the file config.json in Qwen/Qwen2-7B-Instruct.
  warnings.warn(
[2024-09-08 08:18:34,702] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-09-08 08:18:34,705] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-09-08 08:18:34,801] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-09-08 08:18:34,802] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-09-08 08:18:34,858] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
[2024-09-08 08:18:34,900] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step200 is about to be saved!
[2024-09-08 08:18:34,913] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-09-08 08:18:34,913] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-09-08 08:18:38,380] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-09-08 08:18:38,381] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-09-08 08:18:38,479] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-09-08 08:18:38,480] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-200/global_step200/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-09-08 08:18:38,519] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step200 is ready now!
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/other.py:619: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /Qwen/Qwen2-7B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fde58e6f8b0>: Failed to resolve \'huggingface.co\' ([Errno -3] Temporary failure in name resolution)"))'), '(Request ID: 49f9d561-0c7c-4320-951a-22d439bbdb29)') - silently ignoring the lookup for the file config.json in Qwen/Qwen2-7B-Instruct.
  warnings.warn(
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/save_and_load.py:218: UserWarning: Could not find a config file in Qwen/Qwen2-7B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(



 51%|█████████████████████████████████████████████████████████████████▊                                                               | 204/400 [9:28:34<10:13:32, 187.82s/it]




 52%|███████████████████████████████████████████████████████████████████▌                                                              | 208/400 [9:39:32<9:04:31, 170.16s/it]



 53%|████████████████████████████████████████████████████████████████████▌                                                             | 211/400 [9:47:46<8:44:29, 166.51s/it]





 54%|█████████████████████████████████████████████████████████████████████▋                                                           | 216/400 [10:01:33<8:27:50, 165.60s/it]




 55%|██████████████████████████████████████████████████████████████████████▉                                                          | 220/400 [10:12:34<8:16:17, 165.43s/it]




 56%|████████████████████████████████████████████████████████████████████████▏                                                        | 224/400 [10:23:35<8:04:06, 165.03s/it]




 57%|█████████████████████████████████████████████████████████████████████████▌                                                       | 228/400 [10:34:33<7:51:54, 164.62s/it]




 58%|██████████████████████████████████████████████████████████████████████████▊                                                      | 232/400 [10:45:31<7:41:05, 164.67s/it]



 59%|███████████████████████████████████████████████████████████████████████████▊                                                     | 235/400 [10:53:45<7:32:59, 164.73s/it]




 60%|█████████████████████████████████████████████████████████████████████████████                                                    | 239/400 [11:04:44<7:21:56, 164.70s/it]




 61%|██████████████████████████████████████████████████████████████████████████████▎                                                  | 243/400 [11:15:43<7:10:56, 164.69s/it]




 62%|███████████████████████████████████████████████████████████████████████████████▋                                                 | 247/400 [11:26:44<7:01:05, 165.13s/it]




 63%|████████████████████████████████████████████████████████████████████████████████▉                                                | 251/400 [11:37:43<6:49:20, 164.83s/it]




 64%|██████████████████████████████████████████████████████████████████████████████████▏                                              | 255/400 [11:48:42<6:37:59, 164.69s/it]




 65%|███████████████████████████████████████████████████████████████████████████████████▌                                             | 259/400 [11:59:43<6:28:11, 165.19s/it]




 66%|████████████████████████████████████████████████████████████████████████████████████▊                                            | 263/400 [12:10:43<6:16:40, 164.97s/it]




 67%|██████████████████████████████████████████████████████████████████████████████████████                                           | 267/400 [12:21:41<6:05:04, 164.70s/it]




 68%|███████████████████████████████████████████████████████████████████████████████████████▍                                         | 271/400 [12:32:40<5:54:03, 164.68s/it]




 69%|████████████████████████████████████████████████████████████████████████████████████████▋                                        | 275/400 [12:43:40<5:43:33, 164.91s/it]




 70%|█████████████████████████████████████████████████████████████████████████████████████████▉                                       | 279/400 [12:54:40<5:32:45, 165.00s/it]




 71%|███████████████████████████████████████████████████████████████████████████████████████████▎                                     | 283/400 [13:05:40<5:21:48, 165.03s/it]




 72%|████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 287/400 [13:16:39<5:10:21, 164.79s/it]





 73%|██████████████████████████████████████████████████████████████████████████████████████████████▏                                  | 292/400 [13:30:24<4:57:01, 165.02s/it]




 74%|███████████████████████████████████████████████████████████████████████████████████████████████▍                                 | 296/400 [13:41:23<4:45:35, 164.76s/it]



 75%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 300/400 [13:52:22<4:34:39, 164.80s/it]
***** Running Evaluation *****
  Num examples = 58
  Batch size = 1
{'loss': 0.0004, 'grad_norm': 0.012223499827086926, 'learning_rate': 2.5e-05, 'epoch': 35.16}

























































Saving model checkpoint to /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300
{'eval_loss': 0.15845172107219696, 'eval_runtime': 153.5955, 'eval_samples_per_second': 0.378, 'eval_steps_per_second': 0.378, 'epoch': 35.16}
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/other.py:619: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /Qwen/Qwen2-7B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fde4c28fa90>: Failed to resolve \'huggingface.co\' ([Errno -3] Temporary failure in name resolution)"))'), '(Request ID: c4c9f707-c081-47a1-b510-60c0ed3f4f5a)') - silently ignoring the lookup for the file config.json in Qwen/Qwen2-7B-Instruct.
  warnings.warn(
[2024-09-08 12:56:39,173] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step300 is about to be saved!
[2024-09-08 12:56:39,208] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-09-08 12:56:39,208] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-09-08 12:57:05,787] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-09-08 12:57:05,789] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-09-08 12:57:05,886] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-09-08 12:57:05,887] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-09-08 12:57:05,942] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
[2024-09-08 12:57:05,984] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step300 is about to be saved!
[2024-09-08 12:57:05,997] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_model_states.pt
[2024-09-08 12:57:05,997] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_model_states.pt...
[2024-09-08 12:57:09,456] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_model_states.pt.
[2024-09-08 12:57:09,457] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-09-08 12:57:09,583] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-09-08 12:57:09,584] [INFO] [engine.py:3536:_save_zero_checkpoint] zero checkpoint saved /home/piaoxx/piao1/Domain_LLM/checkpoint/domain-csc-20240907225854/checkpoint-300/global_step300/zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-09-08 12:57:09,623] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step300 is ready now!
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/other.py:619: UserWarning: Unable to fetch remote file due to the following error (MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /Qwen/Qwen2-7B-Instruct/resolve/main/config.json (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7fde58111f90>: Failed to resolve \'huggingface.co\' ([Errno -3] Temporary failure in name resolution)"))'), '(Request ID: 6e418ae9-60ad-48b1-98f6-8e1a15caabc8)') - silently ignoring the lookup for the file config.json in Qwen/Qwen2-7B-Instruct.
  warnings.warn(
/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/peft/utils/save_and_load.py:218: UserWarning: Could not find a config file in Qwen/Qwen2-7B-Instruct - will assume that the vocabulary was not modified.
  warnings.warn(

 76%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 302/400 [14:01:37<5:46:26, 212.11s/it]Traceback (most recent call last):
  File "/home/piaoxx/piao1/Domain_LLM/train_new.py", line 160, in <module>
    train()
  File "/home/piaoxx/piao1/Domain_LLM/train_new.py", line 157, in train
    trainer.train()
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/transformers/trainer.py", line 1938, in train
    return inner_training_loop(
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/transformers/trainer.py", line 2279, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/transformers/trainer.py", line 3349, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/accelerate/accelerator.py", line 2151, in backward
    self.deepspeed_engine_wrapped.backward(loss, **kwargs)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/accelerate/utils/deepspeed.py", line 166, in backward
    self.engine.backward(loss, **kwargs)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2020, in backward
    self.optimizer.backward(loss, retain_graph=retain_graph)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/deepspeed/runtime/zero/stage3.py", line 2247, in backward
    self.loss_scaler.backward(loss.float(), retain_graph=retain_graph)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 63, in backward
    scaled_loss.backward(retain_graph=retain_graph)
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/home/piaoxx/miniconda3/envs/env/lib/python3.10/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt